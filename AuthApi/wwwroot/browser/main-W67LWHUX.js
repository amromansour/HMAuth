import{a as F,b as G,c as C,d as B,e as $,f as m}from"./chunk-ZRCRG42Q.js";import{f as O,g as z,q as J}from"./chunk-G6CTQTY5.js";import{a as N,b as D,c as L,d as j}from"./chunk-HCASDCFM.js";import"./chunk-FPPZ4BUR.js";import{Aa as b,Ea as y,G as _,Oa as g,Pa as r,Q as l,Qa as o,Ra as v,S as H,W as R,X as E,Ya as T,_a as a,ab as M,ba as P,ca as S,gb as U,m as h,qa as c,w,wa as I}from"./chunk-NEK5CHBZ.js";var f=(e,i)=>{let t=l(m),n=l(C),d=t.getToken();if(!d)return n.navigate(["/login"]),!1;try{let s=JSON.parse(atob(d.split(".")[1])).exp*1e3;return Date.now()>s?(t.logout(),n.navigate(["/login"]),!1):!0}catch{return t.logout(),n.navigate(["/login"]),!1}return!0};var x=(e,i)=>{let t=l(m),n=l(C),d=t.getToken(),p=e.data.roles,s=t.getRole();return s&&p.includes(s)?!0:(n.navigate(["/unauthorized"]),!1)};var V=[{path:"",pathMatch:"full",loadComponent(){return import("./chunk-MPJS7ACY.js").then(e=>e.Home)},canActivate:[f]},{path:"login",loadComponent(){return import("./chunk-C6T37LKK.js").then(e=>e.Login)}},{path:"Register",loadComponent(){return import("./chunk-YLUYXZEH.js").then(e=>e.Registration)}},{path:"MyProfile",loadComponent(){return import("./chunk-O5LUHXPI.js").then(e=>e.MyProfile)},canActivate:[f,x],data:{roles:["Admin","User"]}},{path:"Users",loadComponent(){return import("./chunk-KIKEJX53.js").then(e=>e.Users)},canActivate:[f,x],data:{roles:["Admin"]}},{path:"NewAdmin",loadComponent(){return import("./chunk-KPQNVLIH.js").then(e=>e.NewAdmin)},canActivate:[f,x],data:{roles:["Admin"]}},{path:"UserPage",loadComponent(){return import("./chunk-TPRB3MQ4.js").then(e=>e.UserPage)},canActivate:[f,x],data:{roles:["User"]}},{path:"unauthorized",loadComponent:()=>import("./chunk-NKGPKJLK.js").then(e=>e.Unauthorized)}];var W=(e,i)=>{let t=l(m),n=t.getToken(),d=e;return n&&(d=e.clone({setHeaders:{Authorization:`Bearer ${n}`}})),i(d).pipe(w(p=>{if(p.status===401){let s=t.refreshToken();return s?s.pipe(_(u=>{if(u._ResponseCode===200&&u.data?.accessToken){t.saveToken(u.data.accessToken),t.saveRefreshToken(u.data.refreshToken);let q=e.clone({setHeaders:{Authorization:`Bearer ${u.data.accessToken}`}});return i(q)}else return t.logout(),location.href="/login",h(()=>p)}),w(()=>(t.logout(),location.href="/login",h(()=>p)))):(t.logout(),location.href="/login",h(()=>p))}return h(()=>p)}))};var Z={providers:[P(),U({eventCoalescing:!0}),$(V),D(L([W])),H(J)]};function X(e,i){e&1&&(r(0,"li")(1,"a",11),a(2,"Users"),o()())}function Y(e,i){e&1&&(r(0,"li")(1,"a",12),a(2,"UserPage"),o()())}function ee(e,i){e&1&&(r(0,"div",13)(1,"a",14),a(2,"Login"),o(),r(3,"a",15),a(4,"Sign-up"),o()())}function te(e,i){if(e&1&&(r(0,"div",13)(1,"h4",16),a(2),v(3,"br"),o(),r(4,"span",16),a(5,"|"),o(),r(6,"small",17),a(7),o(),r(8,"span",16),a(9,"|"),o(),r(10,"a",18),a(11,"Logout"),o()()),e&2){let t=T();c(2),M("Welcome ",t.auth.getName()," "),c(5),M("Role: ",t.auth.getRole()," ")}}var A=class e{constructor(i){this.auth=i}static \u0275fac=function(t){return new(t||e)(I(m))};static \u0275cmp=b({type:e,selectors:[["app-header"]],decls:17,vars:4,consts:[[1,"p-3","bg-dark","text-white"],[1,"container"],[1,"d-flex","flex-wrap","align-items-center","justify-content-center","justify-content-lg-start"],["href","/",1,"d-flex","align-items-center","mb-2","mb-lg-0","text-white","text-decoration-none"],["width","40","height","32","role","img","aria-label","Bootstrap",1,"bi","me-2"],[0,"xlink","href","#bootstrap"],[1,"nav","col-12","col-lg-auto","me-lg-auto","mb-2","justify-content-center","mb-md-0"],["href","/",1,"nav-link","px-2","text-secondary"],["href","MyProfile",1,"nav-link","px-2","text-white"],[4,"ngIf"],["class","text-end",4,"ngIf"],["href","/Users",1,"nav-link","px-2","text-white"],["href","UserPage",1,"nav-link","px-2","text-white"],[1,"text-end"],["routerLink","/login",1,"btn","btn-outline-light","me-2"],["routerLink","/Register",1,"btn","btn-warning"],[1,"me-3"],[2,"font-size","16px"],["routerLink","/logout",1,"btn","btn-outline-light","me-2"]],template:function(t,n){t&1&&(r(0,"header",0)(1,"div",1)(2,"div",2)(3,"a",3),R(),r(4,"svg",4),v(5,"use",5),o()(),E(),r(6,"ul",6)(7,"li")(8,"a",7),a(9,"Home"),o()(),r(10,"li")(11,"a",8),a(12,"My Profile"),o()(),y(13,X,3,0,"li",9)(14,Y,3,0,"li",9),o(),y(15,ee,5,0,"div",10)(16,te,12,2,"div",10),o()()()),t&2&&(c(13),g("ngIf",n.auth.isAdmin()),c(),g("ngIf",n.auth.isUser()),c(),g("ngIf",!n.auth.isAuthenticated()),c(),g("ngIf",n.auth.isAuthenticated()))},dependencies:[B,z,O],styles:[".b-example-divider[_ngcontent-%COMP%]{height:3rem;background-color:#0000001a;border:solid rgba(0,0,0,.15);border-width:1px 0;box-shadow:inset 0 .5em 1.5em #0000001a,inset 0 .125em .5em #00000026}.form-control-dark[_ngcontent-%COMP%]{color:#fff;background-color:var(--bs-dark);border-color:var(--bs-gray)}.form-control-dark[_ngcontent-%COMP%]:focus{color:#fff;background-color:var(--bs-dark);border-color:#fff;box-shadow:0 0 0 .25rem #ffffff40}.bi[_ngcontent-%COMP%]{vertical-align:-.125em;fill:currentColor}.text-small[_ngcontent-%COMP%]{font-size:85%}.dropdown-toggle[_ngcontent-%COMP%]{outline:0}.bd-placeholder-img[_ngcontent-%COMP%]{font-size:1.125rem;text-anchor:middle;-webkit-user-select:none;-moz-user-select:none;user-select:none}@media (min-width: 768px){.bd-placeholder-img-lg[_ngcontent-%COMP%]{font-size:3.5rem}}"]})};var k=class e{title=S("ClientApp");_httpclint=l(N);ngOnInit(){}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=b({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(t,n){t&1&&v(0,"app-header")(1,"router-outlet")},dependencies:[G,j,A],encapsulation:2})};F(k,Z).catch(e=>console.error(e));
